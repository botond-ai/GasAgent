{
  "permissions": {
    "allow": [
      "Bash(if [ -f \"docker-compose.yml\" ])",
      "Bash(then echo \"Found docker-compose.yml\")",
      "Bash(fi)",
      "Bash(if [ -d \"backend\" ])",
      "Bash(then echo \"Found backend/\")",
      "Bash(if [ -d \"frontend\" ])",
      "Bash(then echo \"Found frontend/\")",
      "Bash(npx tsc:*)",
      "Bash(docker exec:*)",
      "Bash(curl:*)",
      "Bash(cat:*)",
      "Bash(docker logs:*)",
      "Bash(docker-compose restart:*)",
      "Bash(python:*)",
      "Bash(powershell.exe -Command \"\n$content = Get-Content ''c:\\\\Projects\\\\supai5\\\\backend\\\\app\\\\workflows\\\\nodes.py'' -Raw\n\n$oldCode = @''\n    async def fleet_lookup\\(self, state: dict\\) -> dict:\n        \"\"\"\"\"\"\n        Node: Lookup device information from FleetDM.\n        \n        Only runs for technical/hardware issues when customer email is available.\n        \n        Args:\n            state: Current workflow state\n            \n        Returns:\n            Updated state with device_info and device_context\n        \"\"\"\"\"\"\n        logger.info\\(f\"\"Looking up device info for ticket: {state[''ticket_id'']}\"\"\\)\n        \n        from app.services.fleet_service import FleetService\n        \n        fleet = FleetService\\(\\)\n        device_info = None\n        device_context = \"\"\"\"\n        \n        # Try to find device by customer email\n        customer_email = state.get\\(\"\"customer_email\"\"\\)\n        if customer_email:\n            device_info = await fleet.search_host\\(customer_email\\)\n            \n            if device_info:\n                # Get full details if we found a match\n                host_id = device_info.get\\(\"\"id\"\"\\)\n                if host_id:\n                    full_details = await fleet.get_host_details\\(host_id\\)\n                    if full_details:\n                        device_info = full_details\n                \n                device_context = fleet.format_device_context\\(device_info\\)\n                logger.info\\(f\"\"Found device for {customer_email}: {device_info.get\\(''hostname''\\)}\"\"\\)\n            else:\n                logger.info\\(f\"\"No device found for {customer_email}\"\"\\)\n        else:\n            logger.debug\\(\"\"No customer email provided, skipping FleetDM lookup\"\"\\)\n        \n        return {\n            \"\"device_info\"\": device_info,\n            \"\"device_context\"\": device_context\n        }\n''@\n\n$newCode = @''\n    async def fleet_lookup\\(self, state: dict\\) -> dict:\n        \"\"\"\"\"\"Node: Lookup device from FleetDM using hostname or email.\"\"\"\"\"\"\n        import re\n        logger.info\\(f\"\"FleetDM lookup for ticket: {state[''ticket_id'']}\"\"\\)\n        from app.services.fleet_service import FleetService\n        fleet = FleetService\\(\\)\n        device_info = None\n        device_context = \"\"\"\"\n        if not fleet.enabled:\n            logger.info\\(\"\"FleetDM not configured\"\"\\)\n            return {\"\"device_info\"\": None, \"\"device_context\"\": \"\"\"\"}\n        raw_message = state.get\\(\"\"raw_message\"\", \"\"\"\"\\)\n        hostname = self._extract_hostname_regex\\(raw_message\\)\n        if hostname:\n            logger.info\\(f\"\"Extracted hostname: {hostname}\"\"\\)\n            device_info = await fleet.search_host\\(hostname\\)\n        if not device_info:\n            email = state.get\\(\"\"customer_email\"\"\\)\n            if email and \"\"@\"\" in email:\n                device_info = await fleet.search_host\\(email\\)\n        if device_info:\n            host_id = device_info.get\\(\"\"id\"\"\\)\n            if host_id:\n                details = await fleet.get_host_details\\(host_id\\)\n                if details:\n                    device_info = details\n            device_context = fleet.format_device_context\\(device_info\\)\n            logger.info\\(f\"\"Found device: {device_info.get\\(''hostname''\\)}\"\"\\)\n        else:\n            logger.info\\(\"\"No device found\"\"\\)\n        return {\"\"device_info\"\": device_info, \"\"device_context\"\": device_context}\n\n    def _extract_hostname_regex\\(self, message: str\\):\n        \"\"\"\"\"\"Extract hostname from message using regex patterns.\"\"\"\"\"\"\n        import re\n        patterns = [r''PD-NB\\\\d+'', r''[A-Z]{2,3}-\\\\d{5,}'', r''DESKTOP-[A-Z0-9]+'', r''[A-Z]+-NB\\\\d+'']\n        for pattern in patterns:\n            match = re.search\\(pattern, message, re.IGNORECASE\\)\n            if match:\n                return match.group\\(0\\).upper\\(\\)\n        return None\n''@\n\n$newContent = $content -replace [regex]::Escape\\($oldCode\\), $newCode\nSet-Content ''c:\\\\Projects\\\\supai5\\\\backend\\\\app\\\\workflows\\\\nodes.py'' -Value $newContent -NoNewline\nWrite-Output ''Done''\n\")",
      "Bash(docker version:*)"
    ]
  }
}
