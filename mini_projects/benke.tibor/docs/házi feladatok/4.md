
# Fail-safe response mechanism prompt-ban
Implement√°lt v√©delmi mechanizmusok:
1. Generation Node Fail-Safe (agent.py)
5 kritikus v√©delem:
CRITICAL FAIL-SAFE INSTRUCTIONS:
1. Only use information from retrieved documents - NO hallucination
2. If contradictory/unclear/missing ‚Üí explicit acknowledgment:
   "Sajn√°lom, nem tudok pontos v√°laszt adni..."
3. Empty context ‚Üí clear communication:
   "Sajn√°lom, nem tal√°ltam relev√°ns inform√°ci√≥t..."
4. Never fabricate: emails, phones, section IDs, policies, dates
5. When uncertain ‚Üí acknowledge + suggest contacting team

Magyar sablon v√°laszok:

‚ùå Ellentmond√°sos info: "Sajn√°lom, az el√©rhet≈ë dokumentumok nem tartalmaznak elegend≈ë inform√°ci√≥t..."
‚ùå √úres context: "Sajn√°lom, nem tal√°ltam relev√°ns inform√°ci√≥t ehhez a k√©rd√©shez..."
‚ö†Ô∏è Bizonytalan: "...k√©rlek, vedd fel a kapcsolatot a [domain] csapattal"
2. Truncated Prompt Fail-Safe (agent.py)
Token limit t√∫ll√©p√©s eset√©n (100k+ tokens):
CRITICAL FAIL-SAFE INSTRUCTIONS:
- Only use information from retrieved documents - NO hallucination
- If missing/unclear ‚Üí "Sajn√°lom, nem tudok pontos v√°laszt adni..."
- Never fabricate details not in documents

3. Memory Update Fail-Safe (agent.py)
Mem√≥ria extrakci√≥n√°l:
IMPORTANT: Only extract facts explicitly stated in conversation.
Do NOT invent, assume, or hallucinate information not present.
If no clear facts/decisions ‚Üí return empty lists.

V√©delem szintjei:
Komponens	Fail-Safe T√≠pus	V√©delem
Generation	5-pontos explicit instruction	Hallucin√°ci√≥, fabrication, empty context
Truncated Gen	3-pontos critical instruction	Token limit eset√©n is v√©delem
Memory Update	Strict extraction rule	Csak explicit facts, no assumption
Pydantic Models	Automatic validation	Type safety, field constraints
Guardrail Node	Validation retry loop	Section ID check, hallucination detection
üéØ Hallucin√°ci√≥ megel≈ëz√©s stackje:
User Query
    ‚Üì
Intent Detection (structured output, validated)
    ‚Üì
RAG Retrieval (actual documents)
    ‚Üì
Generation Prompt ‚Üí FAIL-SAFE INSTRUCTIONS (5 rules)
    ‚Üì
Pydantic Validation (RAGGenerationOutput)
    ‚Üì
Guardrail Node (validation errors check)
    ‚Üì (retry if errors)
Final Answer ‚Üí Validated, Grounded, No Hallucination

# ===========================================================================
# ========== UNIT Tesztek el√©r√©se
# ===========================================================================

backend\tests